
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Insolation library &#8212; Machine Learning GCM</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Small data: 20CRv2c after compression into a 100-dimensional latent space" href="../visualisation/20CRv2c_latent_space/index.html" />
    <link rel="prev" title="Source code for the autoencoder validation" href="../models/autoencoder/validation_source.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../visualisation/20CRv2c_latent_space/index.html" title="Small data: 20CRv2c after compression into a 100-dimensional latent space"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../models/autoencoder/validation_source.html" title="Source code for the autoencoder validation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ML GCM</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../models/autoencoder/index.html" >A variational autoencoder for 20CR</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../models/autoencoder/validation_source.html" accesskey="U">Source code for the autoencoder validation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Weather-Network.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../visualisation/MO_global_analysis/index.html"> Big data: Near-surface temperature, wind, and precipitation, from the Met Office global analysis</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../visualisation/20CRv2c_global_analysis/index.html"> Medium-sized data: Near-surface temperature, wind, and mean-sea-level pressure, from the Twentieth Century Reanalysis version 2c</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/download.html">Download training data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/conversion.html">Process training data for TensorFlow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/autoencoder/index.html">A variational autoencoder</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../visualisation/20CRv2c_latent_space/index.html"> Small data: Near-surface temperature, wind, and mean-sea-level pressure, from the Twentieth Century Reanalysis version 2c, after compression into a 100-dimensional latent space.</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/generator/generator.html">A generative model</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/predictor/index.html">A +6hr predictor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/GCM/index.html">A Machine-Learning GCM using the +6hr predictor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../visualisation/GCM_video/index.html"> Simulated data: Near-surface temperature, wind, and mean-sea-level pressure, from the Machine-Learning GCM.</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../presentations/index.html">Presentation decks and poster</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Small Print</a></li>
</ul>
<h3><a href="https://github.com/philip-brohan/ML_GCM">Get the source code</a></h3>

<a href="https://github.com/philip-brohan/ML_GCM"
           rel="nofollow">Github source repository</a>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/philip-brohan/ML_GCM/issues/new">raise an issue</a>.
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="insolation-library">
<h1>Insolation library<a class="headerlink" href="#insolation-library" title="Permalink to this headline">¶</a></h1>
<p>This library file contains one function:</p>
<dl class="docutils">
<dt>load_insolation:</dt>
<dd>We are using surface clear-sky downwelling UVb as an easily-available proxy for top-of-atmosphere shortwave. We don’t care bout how it varies with the weather, only the diurnal and seasonal cycles, so only one year of data is needed (1969 is downloaded). This function loads the equuivalent 1969 data for the specified time-point.</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Functions for handling insolation data</span>

<span class="c1"># The weather data can mostly be handled by IRData. </span>
<span class="c1"># But the insolation data needs special handling.</span>

<span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># load the insolation data</span>
<span class="k">def</span> <span class="nf">load_insolation</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="p">,</span><span class="n">hour</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">month</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">:</span> <span class="n">day</span><span class="o">=</span><span class="mi">28</span>
    <span class="n">time_constraint</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">PartialDateTime</span><span class="p">(</span>
                                    <span class="n">year</span><span class="o">=</span><span class="mi">1969</span><span class="p">,</span>
                                    <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span>
                                    <span class="n">day</span><span class="o">=</span><span class="n">day</span><span class="p">,</span>
                                    <span class="n">hour</span><span class="o">=</span><span class="n">hour</span><span class="p">))</span>
    <span class="n">ic</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/20CR/version_2c/ensmean/cduvb.1969.nc&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;SCRATCH&#39;</span><span class="p">),</span>
                      <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;3-hourly Clear Sky UV-B Downward Solar Flux&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                      <span class="n">time_constraint</span><span class="p">)</span>
    <span class="n">coord_s</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">coord_systems</span><span class="o">.</span><span class="n">GeogCS</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">fileformats</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">EARTH_RADIUS</span><span class="p">)</span>
    <span class="n">ic</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">coord_system</span><span class="o">=</span><span class="n">coord_s</span>
    <span class="n">ic</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">coord_system</span><span class="o">=</span><span class="n">coord_s</span>
    <span class="k">return</span> <span class="n">ic</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../visualisation/20CRv2c_latent_space/index.html" title="Small data: 20CRv2c after compression into a 100-dimensional latent space"
             >next</a> |</li>
        <li class="right" >
          <a href="../models/autoencoder/validation_source.html" title="Source code for the autoencoder validation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ML GCM</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../models/autoencoder/index.html" >A variational autoencoder for 20CR</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../models/autoencoder/validation_source.html" >Source code for the autoencoder validation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>